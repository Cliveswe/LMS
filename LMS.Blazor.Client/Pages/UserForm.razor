@page "/user/create"
@page "/user/edit/{Id}"

@inject IHttpClientFactory HttpClientFactory
@inject NavigationManager Navigation

<div class="UserForm">
    <h1>@(string.IsNullOrEmpty(Id) ? "Create" : "Edit") User</h1>

    <EditForm Model="@UserModel" OnValidSubmit="HandleSubmit">
        <DataAnnotationsValidator />
        <ValidationSummary />

        <div class="row g-2">
            <div class="col-md">
                <div class="form-floating mb-3">
                    <InputText id="firstName" class="form-control" @bind-Value="UserModel.FirstName" placeholder="First Name" />
                    <label for="firstName">First name</label>
                    <ValidationMessage For="@(() => UserModel.FirstName)" />
                </div>
            </div>
            <div class="col-md">
                <div class="form-floating mb-3">
                    <InputText id="lastName" class="form-control" @bind-Value="UserModel.LastName" placeholder="Last Name" />
                    <label for="lastName">Last name</label>
                    <ValidationMessage For="@(() => UserModel.LastName)" />
                </div>
            </div>
        </div>

        <div class="form-floating mb-3">
            <InputText id="email" class="form-control" @bind-Value="UserModel.Email" placeholder="Email" />
            <label for="email">Email address</label>
            <ValidationMessage For="@(() => UserModel.Email)" />
        </div>

        @if (string.IsNullOrEmpty(Id))
        {
            <div class="form-floating mb-3">
                <InputText id="password" type="password" class="form-control" @bind-Value="UserModel.Password" placeholder="Password" />
                <label for="password">Password</label>
                <ValidationMessage For="@(() => UserModel.Password)" />
            </div>
        }

        <div class="form-floating mb-3">
            <InputSelect id="role" class="form-select" @bind-Value="UserModel.Role" placeholder="Role">
                <option disabled="disabled" selected value="">Select role</option>
                <option value="Student">Student</option>
                <option value="Teacher">Teacher</option>
            </InputSelect>
            <label for="role">Role</label>
            <ValidationMessage For="@(() => UserModel.Role)" />
        </div>

        <!-- Placeholder for Courses selection (e.g., multi-select dropdown) -->
        <div class="form-group">
            <label for="courses">Courses</label>
            <InputSelect id="courses" class="form-control" multiple @bind-Value="UserModel.SelectedCourseIds">
                @foreach (var course in AvailableCourses)
                {
                    <option value="@course.Id">@course.Name</option>
                }
            </InputSelect>
        </div>

        <button type="submit" class="btn btn-success">Create</button>
    </EditForm>
</div>
